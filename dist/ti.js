var ti;(()=>{"use strict";var t={62:(t,e,n)=>{function r(t,e,n,o){var u=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(u,r.prototype),u.expected=e,u.found=n,u.location=o,u.name="SyntaxError",u}function o(t,e,n){return n=n||" ",t.length>e?t:(e-=t.length,t+(n+=n.repeat(e)).slice(0,e))}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(r,Error),r.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<t.length;n++)if(t[n].source===this.location.source){r=t[n].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,a=this.location.source+":"+u.line+":"+u.column;if(r){var i=this.location.end,l=o("",u.line.toString().length," "),s=r[u.line-1],c=(u.line===i.line?i.column:s.length+1)-u.column||1;e+="\n --\x3e "+a+"\n"+l+" |\n"+u.line+" | "+s+"\n"+l+" | "+o("",u.column-1," ")+o("",c,"^")}else e+="\n at "+a}return e},r.buildMessage=function(t,e){var n={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?u(t[0])+"-"+u(t[1]):u(t)}));return"["+(t.inverted?"^":"")+e.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function u(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function a(t){return n[t.type](t)}return"Expected "+function(t){var e,n,r=t.map(a);if(r.sort(),r.length>0){for(e=1,n=1;e<r.length;e++)r[e-1]!==r[e]&&(r[n]=r[e],n++);r.length=n}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:r,parse:function(t,e){var o,u={},a=(e=void 0!==e?e:{}).grammarSource,i={Start:Le},l=Le,s="&theta",c="&list",p="getKey",f=" and ",m=" or ",d=" xor ",h=",",v="Then",S="Else",b="For(",y="While ",g="Repeat ",E="Pause",L="Lbl ",A="Goto ",R="IS>(",I="DS<(",w="Menu(",k="prgm",x="Return",T="Stop",N="DelVar ",B="GraphStyle(",C="OpenLib(",M="ExecLib(",G="Input ",D="Prompt ",U="Disp ",V="DispGraph",P="DispTable",O="Output(",F="ClrHome",H="ClrTable",$="GetCalc(",Y="Get(",j="Send(",W=/^[A-Z]/,K=/^[A-Z0-9]/,X=/^[0-9]/,q=/^[1-6]/,Q=/^[+\-]/,Z=/^[^"]/,_={type:"any"},z=be([["A","Z"]],!1,!1),J=be([["A","Z"],["0","9"]],!1,!1),tt=be([["0","9"]],!1,!1),et=Se(")",!1),nt=Se("&theta",!1),rt=Se("Str",!1),ot=Se("&L",!1),ut=be([["1","6"]],!1,!1),at=Se("&list",!1),it=Se("(",!1),lt=be(["+","-"],!1,!1),st=Se("&E",!1),ct=Se(".",!1),pt=be(['"'],!0,!1),ft=Se('"',!1),mt=Se("Ans",!1),dt=Se("getKey",!1),ht=Se("{",!1),vt=Se("}",!1),St=Se("&-",!1),bt=Se("*",!1),yt=Se("/",!1),gt=Se("+",!1),Et=Se("-",!1),Lt=Se("=",!1),At=Se("!=",!1),Rt=Se(">=",!1),It=Se(">",!1),wt=Se("<=",!1),kt=Se("<",!1),xt=Se(" and ",!1),Tt=Se(" or ",!1),Nt=Se(" xor ",!1),Bt=Se(",",!1),Ct=Se("->",!1),Mt=Se("If ",!1),Gt=Se("Then",!1),Dt=Se("Else",!1),Ut=Se("For(",!1),Vt=Se("While ",!1),Pt=Se("Repeat ",!1),Ot=Se("End",!1),Ft=Se("Pause",!1),Ht=Se("Lbl ",!1),$t=Se("Goto ",!1),Yt=Se("IS>(",!1),jt=Se("DS<(",!1),Wt=Se("Menu(",!1),Kt=Se("prgm",!1),Xt=Se("Return",!1),qt=Se("Stop",!1),Qt=Se("DelVar ",!1),Zt=Se("GraphStyle(",!1),_t=Se("OpenLib(",!1),zt=Se("ExecLib(",!1),Jt=Se("Input ",!1),te=Se("Prompt ",!1),ee=Se("Disp ",!1),ne=Se("DispGraph",!1),re=Se("DispTable",!1),oe=Se("Output(",!1),ue=Se("ClrHome",!1),ae=Se("ClrTable",!1),ie=Se("GetCalc(",!1),le=Se("Get(",!1),se=Se("Send(",!1),ce=0,pe=0,fe=[{line:1,column:1}],me=0,de=[],he=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');l=i[e.startRule]}function ve(){return t.substring(pe,ce)}function Se(t,e){return{type:"literal",text:t,ignoreCase:e}}function be(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function ye(e){var n,r=fe[e];if(r)return r;for(n=e-1;!fe[n];)n--;for(r={line:(r=fe[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return fe[e]=r,r}function ge(t,e){var n=ye(t),r=ye(e);return{source:a,start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Ee(t){ce<me||(ce>me&&(me=ce,de=[]),de.push(t))}function Le(){var e;return e=function(){var e;return(e=function(){var t,e,n;return t=ce,e=ce,he++,n=Ae(),he--,n===u?e=void 0:(ce=e,e=u),e!==u&&(pe=t,e={type:Je.EmptyStatement}),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,(n=_e())!==u?("->"===t.substr(ce,2)?(r="->",ce+=2):(r=u,0===he&&Ee(Ct)),r!==u&&(o=Ge())!==u?(pe=e,a=n,i=o,e={type:Je.AssignmentStatement,value:a,assignable:i}):(ce=e,e=u)):(ce=e,e=u),e}())===u&&(e=function(){var e;return(e=function(){var e,n,r,o,a,i;return e=ce,"If "===t.substr(ce,3)?(n="If ",ce+=3):(n=u,0===he&&Ee(Mt)),n!==u?((r=_e())===u&&(r=null),(o=ke())===u&&(o=null),pe=e,a=r,i=o,e={type:Je.IfStatement,value:a,extra:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,4)===v?(n=v,ce+=4):(n=u,0===he&&Ee(Gt)),n!==u?((r=ke())===u&&(r=null),pe=e,o=r,e={type:Je.ThenStatement,extra:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,4)===S?(n=S,ce+=4):(n=u,0===he&&Ee(Dt)),n!==u?((r=ke())===u&&(r=null),pe=e,o=r,e={type:Je.ElseStatement,extra:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i,l,s,c,p,f,m,d,h;return e=ce,t.substr(ce,4)===b?(n=b,ce+=4):(n=u,0===he&&Ee(Ut)),n!==u?((r=Me())===u&&(r=null),(o=ze())===u&&(o=null),(a=ze())===u&&(a=null),(i=ze())===u&&(i=null),l=function(){var t,e,n;if(t=ce,e=[],(n=ze())!==u)for(;n!==u;)e.push(n),n=ze();else e=u;return e!==u&&(pe=t,e=!0),e}(),l===u&&(l=null),xe(),(s=ke())===u&&(s=null),pe=e,c=r,p=o,f=a,m=i,d=l,h=s,e={type:Je.ForLoop,variable:c,start:p,end:f,step:m,args:d,extra:h}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,6)===y?(n=y,ce+=6):(n=u,0===he&&Ee(Vt)),n!==u?((r=_e())===u&&(r=null),(o=ke())===u&&(o=null),pe=e,a=r,i=o,e={type:Je.WhileLoop,value:a,extra:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,7)===g?(n=g,ce+=7):(n=u,0===he&&Ee(Pt)),n!==u?((r=_e())===u&&(r=null),(o=ke())===u&&(o=null),pe=e,a=r,i=o,e={type:Je.RepeatLoop,value:a,extra:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,"End"===t.substr(ce,3)?(n="End",ce+=3):(n=u,0===he&&Ee(Ot)),n!==u?((r=ke())===u&&(r=null),pe=e,o=r,e={type:Je.EndStatement,extra:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,5)===E?(n=E,ce+=5):(n=u,0===he&&Ee(Ft)),n!==u&&(pe=e,n={type:Je.PauseStatement}),n}())===u&&((e=function(){var e,n,r,o;return e=ce,t.substr(ce,4)===L?(n=L,ce+=4):(n=u,0===he&&Ee(Ht)),n!==u&&(r=Te())!==u?(pe=e,o=r,e={type:Je.LabelStatement,location:o}):(ce=e,e=u),e}())===u&&((e=function(){var e,n,r,o;return e=ce,t.substr(ce,5)===A?(n=A,ce+=5):(n=u,0===he&&Ee($t)),n!==u&&(r=Te())!==u?(pe=e,o=r,e={type:Je.GotoStatement,location:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,4)===R?(n=R,ce+=4):(n=u,0===he&&Ee(Yt)),n!==u?((r=Me())===u&&(r=null),(o=ze())===u&&(o=null),xe(),pe=e,a=r,i=o,e={type:Je.IncrementSkip,variable:a,end:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,4)===I?(n=I,ce+=4):(n=u,0===he&&Ee(jt)),n!==u?((r=Me())===u&&(r=null),(o=ze())===u&&(o=null),xe(),pe=e,a=r,i=o,e={type:Je.DecrementSkip,variable:a,end:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i,l,s,c;if(e=ce,t.substr(ce,5)===w?(n=w,ce+=5):(n=u,0===he&&Ee(Wt)),n!==u){for((r=_e())===u&&(r=null),o=[],a=ce,44===t.charCodeAt(ce)?(i=h,ce++):(i=u,0===he&&Ee(Bt)),i!==u&&(l=Pe())!==u?(44===t.charCodeAt(ce)?(s=h,ce++):(s=u,0===he&&Ee(Bt)),s!==u&&(c=Te())!==u?a=i=[i,l,s,c]:(ce=a,a=u)):(ce=a,a=u);a!==u;)o.push(a),a=ce,44===t.charCodeAt(ce)?(i=h,ce++):(i=u,0===he&&Ee(Bt)),i!==u&&(l=Pe())!==u?(44===t.charCodeAt(ce)?(s=h,ce++):(s=u,0===he&&Ee(Bt)),s!==u&&(c=Te())!==u?a=i=[i,l,s,c]:(ce=a,a=u)):(ce=a,a=u);a=xe(),pe=e,e=function(t,e){return tn.buildMenuStatement(t,e)}(r,o)}else ce=e,e=u;return e}(),e===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,4)===k?(n=k,ce+=4):(n=u,0===he&&Ee(Kt)),n!==u&&(r=Ne())!==u?(pe=e,o=r,e={type:Je.ProgramStatement,name:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,6)===x?(n=x,ce+=6):(n=u,0===he&&Ee(Xt)),n!==u&&(pe=e,n={type:Je.ReturnStatement}),n}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,4)===T?(n=T,ce+=4):(n=u,0===he&&Ee(qt)),n!==u&&(pe=e,n={type:Je.StopStatement}),n}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,7)===N?(n=N,ce+=7):(n=u,0===he&&Ee(Qt)),n!==u?((r=Me())===u&&(r=null),pe=e,o=r,e={type:Je.DelVarStatement,variable:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,11)===B?(n=B,ce+=11):(n=u,0===he&&Ee(Zt)),n!==u?((r=_e())===u&&(r=null),(o=ze())===u&&(o=null),xe(),pe=e,a=r,i=o,e={type:Je.GraphStyleStatement,equation:a,style:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,8)===C?(n=C,ce+=8):(n=u,0===he&&Ee(_t)),n!==u&&(r=Ne())!==u?(xe(),pe=e,o=r,e={type:Je.OpenLibStatement,name:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,8)===M?(n=M,ce+=8):(n=u,0===he&&Ee(zt)),n!==u&&(r=Ne())!==u?(xe(),pe=e,o=r,e={type:Je.ExecLibStatement,name:o}):(ce=e,e=u),e}())))),e}(),e===u&&(e=function(){var e;return e=function(){var e,n,r,o;return e=ce,t.substr(ce,6)===G?(n=G,ce+=6):(n=u,0===he&&Ee(Jt)),n!==u?(r=function(){var e,n,r;return e=ce,(n=_e())!==u?(44===t.charCodeAt(ce)?(r=h,ce++):(r=u,0===he&&Ee(Bt)),r!==u?e=n:(ce=e,e=u)):(ce=e,e=u),e}(),r===u&&(r=null),(o=Me())===u&&(o=null),pe=e,e=function(t,e){return{type:Je.Input,text:t,variable:e}}(r,o)):(ce=e,e=u),e}(),e===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,7)===D?(n=D,ce+=7):(n=u,0===he&&Ee(te)),n!==u?((r=Me())===u&&(r=null),pe=e,o=r,e={type:Je.Prompt,variable:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,5)===U?(n=U,ce+=5):(n=u,0===he&&Ee(ee)),n!==u?((r=_e())===u&&(r=null),pe=e,o=r,e={type:Je.Display,value:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,9)===V?(n=V,ce+=9):(n=u,0===he&&Ee(ne)),n!==u&&(pe=e,n={type:Je.DispGraph}),n}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,9)===P?(n=P,ce+=9):(n=u,0===he&&Ee(re)),n!==u&&(pe=e,n={type:Je.DispTable}),n}())===u&&(e=function(){var e,n,r,o,a,i,l,s;return e=ce,t.substr(ce,7)===O?(n=O,ce+=7):(n=u,0===he&&Ee(oe)),n!==u?((r=_e())===u&&(r=null),(o=ze())===u&&(o=null),(a=ze())===u&&(a=null),xe(),pe=e,i=r,l=o,s=a,e={type:Je.Output,row:i,column:l,value:s}):(ce=e,e=u),e}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,7)===F?(n=F,ce+=7):(n=u,0===he&&Ee(ue)),n!==u&&(pe=e,n={type:Je.ClrHome}),n}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,8)===H?(n=H,ce+=8):(n=u,0===he&&Ee(ae)),n!==u&&(pe=e,n={type:Je.ClrTable}),n}())===u&&(e=function(){var e,n,r,o,a,i;return e=ce,t.substr(ce,8)===$?(n=$,ce+=8):(n=u,0===he&&Ee(ie)),n!==u?((r=Me())===u&&(r=null),(o=ze())===u&&(o=null),xe(),pe=e,a=r,i=o,e={type:Je.GetCalc,variable:a,portflag:i}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,4)===Y?(n=Y,ce+=4):(n=u,0===he&&Ee(le)),n!==u?((r=Me())===u&&(r=null),xe(),pe=e,o=r,e={type:Je.Get,variable:o}):(ce=e,e=u),e}())===u&&(e=function(){var e,n,r,o;return e=ce,t.substr(ce,5)===j?(n=j,ce+=5):(n=u,0===he&&Ee(se)),n!==u?((r=Me())===u&&(r=null),xe(),pe=e,o=r,e={type:Je.Send,variable:o}):(ce=e,e=u),e}()),e}(),e===u&&(e=function(){var t,e,n;return t=ce,(e=_e())!==u&&(pe=t,n=e,e={type:Je.ValueStatement,value:n}),e}()))),e}(),e}function Ae(){var e;return t.length>ce?(e=t.charAt(ce),ce++):(e=u,0===he&&Ee(_)),e}function Re(){var e;return W.test(t.charAt(ce))?(e=t.charAt(ce),ce++):(e=u,0===he&&Ee(z)),e}function Ie(){var e;return K.test(t.charAt(ce))?(e=t.charAt(ce),ce++):(e=u,0===he&&Ee(J)),e}function we(){var e;return X.test(t.charAt(ce))?(e=t.charAt(ce),ce++):(e=u,0===he&&Ee(tt)),e}function ke(){var t,e,n;if(t=ce,e=[],(n=Ae())!==u)for(;n!==u;)e.push(n),n=Ae();else e=u;return e!==u&&(pe=t,e=!0),e}function xe(){var e;return 41===t.charCodeAt(ce)?(e=")",ce++):(e=u,0===he&&Ee(et)),e===u&&(e=null),e}function Te(){var t;return t=ce,Ie()!==u?(Ie(),pe=t,t=ve()):(ce=t,t=u),t}function Ne(){var t;return t=ce,Re()!==u?(Ie(),Ie(),Ie(),Ie(),Ie(),Ie(),Ie(),pe=t,t=ve()):(ce=t,t=u),t}function Be(){var e,n,r;return e=ce,(n=function(){var e,n;return e=ce,"Str"===t.substr(ce,3)?(n="Str",ce+=3):(n=u,0===he&&Ee(rt)),n!==u&&we()!==u?(pe=e,e=ve()):(ce=e,e=u),e}())!==u&&(pe=e,r=n,n={type:Je.STRINGVARIABLE,name:r}),n}function Ce(){var e,n,r;return e=ce,n=function(){var e,n,r;return e=ce,"&L"===t.substr(ce,2)?(n="&L",ce+=2):(n=u,0===he&&Ee(ot)),n!==u?(q.test(t.charAt(ce))?(r=t.charAt(ce),ce++):(r=u,0===he&&Ee(ut)),r!==u?(pe=e,e="List"+r):(ce=e,e=u)):(ce=e,e=u),e}(),n!==u&&(pe=e,r=n,n={type:Je.LISTVARIABLE,name:r,custom:!1}),(e=n)===u&&(e=ce,(n=function(){var e,n;return e=ce,t.substr(ce,5)===c?(n=c,ce+=5):(n=u,0===he&&Ee(at)),n!==u&&Re()!==u?(Ie(),Ie(),Ie(),Ie(),pe=e,e="List"+ve().substring(5)):(ce=e,e=u),e}())!==u&&(pe=e,n=function(t){return{type:Je.LISTVARIABLE,name:t,custom:!0}}(n)),e=n),e}function Me(){var e;return(e=Be())===u&&(e=function(){var e,n,r;return e=ce,n=function(){var e,n;return(e=Re())===u&&(e=ce,t.substr(ce,6)===s?(n=s,ce+=6):(n=u,0===he&&Ee(nt)),n!==u&&(pe=e,n="THETA"),e=n),e}(),n!==u&&(pe=e,r=n,n={type:Je.VARIABLE,name:r}),n}())===u&&(e=Ce()),e}function Ge(){var e;return(e=function(){var e,n,r,o,a,i;return e=ce,(n=Ce())!==u?(40===t.charCodeAt(ce)?(r="(",ce++):(r=u,0===he&&Ee(it)),r!==u&&(o=_e())!==u?(xe(),pe=e,a=n,i=o,e={type:Je.LISTINDEX,list:a,index:i}):(ce=e,e=u)):(ce=e,e=u),e}())===u&&(e=Me()),e}function De(){var e,n,r;if(e=ce,n=[],(r=we())!==u)for(;r!==u;)n.push(r),r=we();else n=u;return n!==u?t.substring(e,ce):n}function Ue(){var e,n,r,o;return e=ce,n=function(){var e;return"&E"===t.substr(ce,2)?(e="&E",ce+=2):(e=u,0===he&&Ee(st)),e}(),n!==u?(r=ce,o=function(){var e,n,r,o;return e=ce,n=ce,Q.test(t.charAt(ce))?(r=t.charAt(ce),ce++):(r=u,0===he&&Ee(lt)),r===u&&(r=null),(o=De())!==u?n=r=[r,o]:(ce=n,n=u),n!==u?t.substring(e,ce):n}(),(r=o!==u?t.substring(r,ce):o)!==u?e=r:(ce=e,e=u)):(ce=e,e=u),e}function Ve(){var e;return Z.test(t.charAt(ce))?(e=t.charAt(ce),ce++):(e=u,0===he&&Ee(pt)),e}function Pe(){var e,n,r,o,a;return e=ce,34===t.charCodeAt(ce)?(n='"',ce++):(n=u,0===he&&Ee(ft)),n!==u?(r=function(){var e,n,r;for(e=ce,n=[],r=Ve();r!==u;)n.push(r),r=Ve();return t.substring(e,ce)}(),34===t.charCodeAt(ce)?(o='"',ce++):(o=u,0===he&&Ee(ft)),o===u&&(o=null),pe=e,a=r,e={type:Je.STRING,chars:a}):(ce=e,e=u),e}function Oe(){var e;return(e=function(){var e;return(e=function(){var e,n;return e=ce,"Ans"===t.substr(ce,3)?(n="Ans",ce+=3):(n=u,0===he&&Ee(mt)),n!==u&&(pe=e,n={type:Je.ANS}),n}())===u&&(e=function(){var e,n;return e=ce,t.substr(ce,6)===p?(n=p,ce+=6):(n=u,0===he&&Ee(dt)),n!==u&&(pe=e,n={type:Je.GetKey}),n}()),e}())===u&&(e=Ge())===u&&(e=Pe()),e}function Fe(){var e;return"&-"===t.substr(ce,2)?(e="&-",ce+=2):(e=u,0===he&&Ee(St)),e}function He(){var e,n,r,o,a;return e=function(){var e,n,r,o;return(e=Oe())===u&&(e=ce,40===t.charCodeAt(ce)?(n="(",ce++):(n=u,0===he&&Ee(it)),n!==u&&(r=_e())!==u?(41===t.charCodeAt(ce)?(o=")",ce++):(o=u,0===he&&Ee(et)),o!==u?e=r:(ce=e,e=u)):(ce=e,e=u),e===u&&(e=function(){var e,n,r,o,a,i,l;if(e=ce,123===t.charCodeAt(ce)?(n="{",ce++):(n=u,0===he&&Ee(ht)),n!==u)if((r=_e())!==u){for(o=[],a=ze();a!==u;)o.push(a),a=ze();125===t.charCodeAt(ce)?(a="}",ce++):(a=u,0===he&&Ee(vt)),a===u&&(a=null),pe=e,i=r,l=o,e=tn.buildList(i,l)}else ce=e,e=u;else ce=e,e=u;return e}())),e}(),e===u&&(e=ce,(n=Fe())!==u&&(r=He())!==u?(pe=e,o=n,a=r,e={type:Je.UNARY,operator:o,argument:a}):(ce=e,e=u)),e}function $e(){var e,n,r,o,a;return(e=He())===u&&(e=function(){var e,n,r,o,a,i,l,s;return e=ce,(n=De())!==u?(46===t.charCodeAt(ce)?(r=".",ce++):(r=u,0===he&&Ee(ct)),r!==u?((o=De())===u&&(o=null),(a=Ue())===u&&(a=null),pe=e,i=n,l=o,s=a,e={type:Je.NUMBER,integer:i,fraction:l,exponent:s}):(ce=e,e=u)):(ce=e,e=u),e===u&&(e=ce,46===t.charCodeAt(ce)?(n=".",ce++):(n=u,0===he&&Ee(ct)),n!==u&&(r=De())!==u?((o=Ue())===u&&(o=null),pe=e,e=function(t,e){return{type:Je.NUMBER,fraction:t,exponent:e}}(r,o)):(ce=e,e=u),e===u&&(e=ce,(n=De())!==u?((r=Ue())===u&&(r=null),pe=e,e=function(t,e){return{type:Je.NUMBER,integer:t,exponent:e}}(n,r)):(ce=e,e=u))),e}())===u&&(e=ce,(n=Fe())!==u&&(r=$e())!==u?(pe=e,o=n,a=r,e={type:Je.UNARY,operator:o,argument:a}):(ce=e,e=u)),e}function Ye(){var t,e,n,r,o,a,i,l,s;if(t=ce,(e=He())!==u){for(n=[],r=ce,(o=$e())!==u&&(a=He())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=$e())!==u&&(a=He())!==u?r=o=[o,a]:(ce=r,r=u);(r=$e())===u&&(r=null),pe=t,i=e,l=n,s=r,t=tn.buildImplicitBinaryExpression(i,l,s)}else ce=t,t=u;if(t===u){if(t=ce,(e=$e())!==u){for(n=[],r=ce,(o=He())!==u&&(a=$e())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=He())!==u&&(a=$e())!==u?r=o=[o,a]:(ce=r,r=u);(r=He())===u&&(r=null),pe=t,t=function(t,e,n){return tn.buildImplicitBinaryExpression(t,e,n)}(e,n,r)}else ce=t,t=u;t===u&&(t=$e())}return t}function je(){var e;return 42===t.charCodeAt(ce)?(e="*",ce++):(e=u,0===he&&Ee(bt)),e===u&&(47===t.charCodeAt(ce)?(e="/",ce++):(e=u,0===he&&Ee(yt))),e}function We(){var t,e,n,r,o,a,i,l;if(t=ce,(e=Ye())!==u){for(n=[],r=ce,(o=je())!==u&&(a=Ye())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=je())!==u&&(a=Ye())!==u?r=o=[o,a]:(ce=r,r=u);pe=t,i=e,l=n,t=tn.buildBinaryExpression(i,l)}else ce=t,t=u;return t}function Ke(){var e;return 43===t.charCodeAt(ce)?(e="+",ce++):(e=u,0===he&&Ee(gt)),e===u&&(45===t.charCodeAt(ce)?(e="-",ce++):(e=u,0===he&&Ee(Et))),e}function Xe(){var t,e,n,r,o,a,i,l;if(t=ce,(e=We())!==u){for(n=[],r=ce,(o=Ke())!==u&&(a=We())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=Ke())!==u&&(a=We())!==u?r=o=[o,a]:(ce=r,r=u);pe=t,i=e,l=n,t=tn.buildBinaryExpression(i,l)}else ce=t,t=u;return t}function qe(){var e;return 61===t.charCodeAt(ce)?(e="=",ce++):(e=u,0===he&&Ee(Lt)),e===u&&("!="===t.substr(ce,2)?(e="!=",ce+=2):(e=u,0===he&&Ee(At)),e===u&&(">="===t.substr(ce,2)?(e=">=",ce+=2):(e=u,0===he&&Ee(Rt)),e===u&&(62===t.charCodeAt(ce)?(e=">",ce++):(e=u,0===he&&Ee(It)),e===u&&("<="===t.substr(ce,2)?(e="<=",ce+=2):(e=u,0===he&&Ee(wt)),e===u&&(60===t.charCodeAt(ce)?(e="<",ce++):(e=u,0===he&&Ee(kt))))))),e}function Qe(){var t,e,n,r,o,a,i,l;if(t=ce,(e=Xe())!==u){for(n=[],r=ce,(o=qe())!==u&&(a=Xe())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=qe())!==u&&(a=Xe())!==u?r=o=[o,a]:(ce=r,r=u);pe=t,i=e,l=n,t=tn.buildBinaryExpression(i,l)}else ce=t,t=u;return t}function Ze(){var e;return t.substr(ce,5)===f?(e=f,ce+=5):(e=u,0===he&&Ee(xt)),e===u&&(t.substr(ce,4)===m?(e=m,ce+=4):(e=u,0===he&&Ee(Tt)),e===u&&(t.substr(ce,5)===d?(e=d,ce+=5):(e=u,0===he&&Ee(Nt)))),e}function _e(){var t,e,n,r,o,a,i,l;if(t=ce,(e=Qe())!==u){for(n=[],r=ce,(o=Ze())!==u&&(a=Qe())!==u?r=o=[o,a]:(ce=r,r=u);r!==u;)n.push(r),r=ce,(o=Ze())!==u&&(a=Qe())!==u?r=o=[o,a]:(ce=r,r=u);pe=t,i=e,l=n,t=tn.buildBinaryExpression(i,l)}else ce=t,t=u;return t}function ze(){var e,n,r;return e=ce,44===t.charCodeAt(ce)?(n=h,ce++):(n=u,0===he&&Ee(Bt)),n!==u&&(r=_e())!==u?e=r:(ce=e,e=u),e}const Je=n(831),tn=n(802);if((o=l())!==u&&ce===t.length)return o;throw o!==u&&ce<t.length&&Ee({type:"end"}),en=de,nn=me<t.length?t.charAt(me):null,rn=me<t.length?ge(me,me+1):ge(me,me),new r(r.buildMessage(en,nn),en,nn,rn);var en,nn,rn}}},831:(t,e,n)=>{n.r(e),n.d(e,{ANS:()=>s,AssignmentStatement:()=>y,BINARY:()=>h,ClrHome:()=>K,ClrTable:()=>X,DecrementSkip:()=>B,DelVarStatement:()=>U,DispGraph:()=>Y,DispTable:()=>j,Display:()=>$,ElseStatement:()=>L,EmptyStatement:()=>S,EndStatement:()=>w,ExecLibStatement:()=>O,ForLoop:()=>A,Get:()=>Q,GetCalc:()=>q,GetKey:()=>c,GotoStatement:()=>T,GraphStyleStatement:()=>V,IfStatement:()=>g,IncrementSkip:()=>N,Input:()=>F,LIST:()=>i,LISTINDEX:()=>d,LISTVARIABLE:()=>m,LabelStatement:()=>x,MenuStatement:()=>C,NUMBER:()=>a,OpenLibStatement:()=>P,Output:()=>W,PauseStatement:()=>k,ProgramStatement:()=>M,Prompt:()=>H,RepeatLoop:()=>I,ReturnStatement:()=>G,STRING:()=>l,STRINGVARIABLE:()=>f,Send:()=>Z,StopStatement:()=>D,SyntaxError:()=>u,ThenStatement:()=>E,UNARY:()=>v,VARIABLE:()=>p,ValueStatement:()=>b,WhileLoop:()=>R,lib:()=>o,ti:()=>r});const r="ti",o="lib",u="SyntaxError",a="number",i="list",l="string",s="ans",c="GetKey",p="variable",f="stringVariable",m="listVariable",d="listIndex",h="binary",v="unary",S="empty",b="value",y="assign",g="IfStatement",E="ThenStatement",L="ElseStatement",A="ForLoop",R="WhileLoop",I="RepeatLoop",w="EndStatement",k="PauseStatement",x="LabelStatement",T="GotoStatement",N="IncrementSkip",B="DecrementSkip",C="MenuStatement",M="ProgramStatement",G="ReturnStatement",D="StopStatement",U="DelVarStatement",V="GraphStyleStatement",P="OpenLibStatement",O="ExecLibStatement",F="Input",H="Prompt",$="display",Y="DispGraph",j="DispTable",W="Output",K="ClrHome",X="ClrTable",q="GetCalc",Q="Get",Z="Send"},802:(t,e,n)=>{n.r(e),n.d(e,{buildBinaryExpression:()=>o,buildImplicitBinaryExpression:()=>u,buildList:()=>i,buildMenuStatement:()=>a});var r=n(831);function o(t,e){return e.reduce((function(t,e){return{type:r.BINARY,operator:e[0],left:t,right:e[1]}}),t)}function u(t,e,n){const o=e.flat();return null!==n&&o.push(n),o.reduce((function(t,e){return{type:r.BINARY,operator:"*",left:t,right:e}}),t)}function a(t,e){const n=e.map((function(t){return{option:t[1],location:t[3]}}));return{type:r.MenuStatement,title:t,choices:n}}function i(t,e){return{type:r.LIST,elements:[t].concat(e)}}}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var u=e[r]={exports:{}};return t[r](u,u.exports,n),u.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{exec:()=>rt,on:()=>et,parse:()=>R,run:()=>nt});var t=n(831);function e(t,e,n=!1){return{type:t,code:e,hideSource:n}}function o(n,r=!1){return e(t.ti,n,r)}const u=o("DATA TYPE"),a=o("SYNTAX"),i=o("UNDEFINED"),l=o("LABEL"),s=o("ARGUMENT"),c=o("DIM MISMATCH"),p=o("DIVIDE BY 0"),f=o("INVALID DIM"),m=o("DOMAIN");function d(n,r=!1){return e(t.lib,n,r)}const h=d("unimplemented");function v(e=0){return{type:t.NUMBER,float:e}}const S=v(1),b=v(-1),y="done",g="faulted",E="suspend";var L=n(62),A=n.n(L);function R(t,e={}){if(void 0===t)throw new Error("Undefined source!");const n=e.sourceMap||"inline",r=t.split(/\r?\n/).map((t=>{let e;try{e=A().parse(t)}catch(t){if("SyntaxError"!==t.name)throw t;e={type:"SyntaxError"}}return"inline"===n&&(e.source=t),e}));return r}function I(e){if(e.type===t.NUMBER)return 0!==e.float;throw u}function w(e,n,r){if(n.type===t.STRINGVARIABLE){if(r.type!==t.STRING)throw u}else if(n.type===t.VARIABLE){if(r.type!==t.NUMBER)return}else if(n.type===t.LISTVARIABLE){if(r.type!==t.LIST)throw u}else{if(n.type!==t.LISTINDEX)throw d("unexpected variable type");if(r.type!==t.LIST)throw u}e.vars[n.name]=r}function k(t,e){t.ans=e}function x(e,n,r){return{type:t.BINARY,operator:n,left:e,right:r}}function T(t){let e="";return void 0!==t.integer&&null!==t.integer&&(e+=t.integer),void 0!==t.fraction&&null!==t.fraction&&(e+="."+t.fraction),void 0!==t.exponent&&null!==t.exponent&&(e+="e"+t.exponent),parseFloat(e)}function N(e,n=!1){if(n&&e.type!==t.STRING)throw u;let r="";switch(e.type){case t.NUMBER:r=e.float.toString(),r.startsWith("0.")&&(r=r.substring(1));break;case t.STRING:r=e.chars;break;case t.LIST:r="{"+e.elements.map((t=>N(t))).join(" ")+"}";break;default:throw d("unexpected value tostring")}return r}function B(t,e){const n=C[t.type];if(void 0===n)throw d("unexpected value");return n(t,e)}const C={};C[t.SyntaxError]=(t,e)=>{throw a},C[t.NUMBER]=(e,n)=>void 0!==e.float?e:{type:t.NUMBER,float:T(e)},C[t.STRING]=(t,e)=>t,C[t.LIST]=(e,n)=>!0===e.resolved?e:{type:t.LIST,elements:e.elements.map((function(e){const r=B(e,n);if(r.type!==t.NUMBER)throw u;return r})),resolved:!0},C[t.VARIABLE]=(t,e)=>{let n=e.vars[t.name];return void 0===n&&(n=e.vars[t.name]=v()),n},C[t.STRINGVARIABLE]=(t,e)=>{const n=e.vars[t.name];if(void 0===n)throw i;return n},C[t.LISTVARIABLE]=(t,e)=>{const n=e.vars[t.name];if(void 0===n)throw i;return n},C[t.LISTINDEX]=(e,n)=>{const r=B(e.list,n),o=B(e.index,n);if(o.type!==t.NUMBER)throw f;if(o.float<1||o.float>r.elements.length)throw f;return{type:t.NUMBER,float:r.elements[o.float-1].float}},C[t.ANS]=(t,e)=>e.ans,C[t.GetKey]=(t,e)=>{throw h},C[t.UNARY]=(t,e)=>{const n=B(t.argument,e),r=M[n.type];if(void 0===r)throw d("unexpected unary argument");return r(t.operator,n)},C[t.BINARY]=(t,e)=>{const n=B(t.left,e),r=B(t.right,e),o=G[n.type];if(void 0===o)throw d("unexpected binary left");return o(t.operator,n,r)};const M={};M[t.NUMBER]=(e,n)=>({type:t.NUMBER,float:U(e,n.float)}),M[t.STRING]=(t,e)=>{throw u},M[t.LIST]=(e,n)=>({type:t.LIST,elements:n.elements.map((n=>({type:t.NUMBER,float:U(e,n.float)}))),resolved:!0});const G={};function D(e,n,r){return{type:t.LIST,elements:n.elements.map(((n,o)=>({type:t.NUMBER,float:V(e,n.float,r.float)}))),resolved:!0}}function U(t,e){if("&-"===t)return-1*e;throw d("unexpected unary operator")}function V(t,e,n){if("/"===t&&0===n)throw p;switch(t){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"=":return e===n?1:0;case"!=":return e!==n?1:0;case">=":return e>=n?1:0;case">":return e>n?1:0;case"<=":return e<=n?1:0;case"<":return e<n?1:0;case" and ":return e&&n?1:0;case" or ":return e||n?1:0;case" xor ":return!e&&n||e&&!n?1:0;default:throw d("unexpected binary operator")}}G[t.NUMBER]=(e,n,r)=>{if(r.type!==t.NUMBER){if(r.type===t.LIST)return D(e,r,n);throw u}return{type:t.NUMBER,float:V(e,n.float,r.float)}},G[t.STRING]=(e,n,r)=>{if(r.type!==t.STRING)throw u;if(["+"].includes(e))return{type:t.STRING,chars:V(e,n.chars,r.chars)};if(["=","!="].includes(e))return{type:t.NUMBER,float:V(e,n.chars,r.chars)};throw u},G[t.LIST]=(e,n,r)=>{if(r.type!==t.LIST){if(r.type===t.NUMBER)return D(e,n,r);throw u}if(n.elements.length!==r.elements.length)throw c;return{type:t.LIST,elements:n.elements.map(((n,o)=>({type:t.NUMBER,float:V(e,n.float,r.elements[o].float)}))),resolved:!0}};const P={};function O(t,e={},n=!0){void 0!==e.output?e.output(t,n):console.log(t)}function F(t,e={}){void 0!==e.stdin&&""!==e.stdin&&void 0===e.stdinQueue&&(e.stdinQueue=e.stdin.split("\n").reverse()),void 0===e.stdinQueue?void 0!==e.input?(setTimeout((()=>e.input.val("")),0),e.input.on("keypress",(n=>{if(13===n.keyCode){const n=e.input.val();setTimeout((()=>e.input.val("")),0),!0!==t(n)&&e.input.off("keypress")}}))):setTimeout((()=>{!0===t(prompt("Input?"))&&F(t,e)}),100):setTimeout((()=>{const n=e.stdinQueue.pop();!0===t(n)&&F(t,e)}),0)}P[t.VARIABLE]=(e,n,r)=>{n.type===t.NUMBER&&(r.vars[e.name]=n)},P[t.STRINGVARIABLE]=(e,n,r)=>{if(n.type!==t.STRING)throw u;r.vars[e.name]=n},P[t.LISTVARIABLE]=(e,n,r)=>{if(n.type!==t.LIST)throw u;r.vars[e.name]=n},P[t.LISTINDEX]=(e,n,r)=>{const o=B(e.list,r),a=B(e.index,r);if(a.type!==t.NUMBER)throw u;if(a.float<1||a.float>o.elements.length)throw f;r.vars[e.list.name].elements[a.float-1]=n};const H={};function $(e,n,r){if(!function(t,e){return e.name in t.vars}(e,n))throw i;w(e,n,B({type:t.BINARY,operator:"+",left:n,right:r},e))}function Y(e,n,r,o){return O(e,r.io,!1),F((e=>{if(null==e||""===e)return!0;r.resume((()=>{let u;O(e,r.io),u=n.type===t.STRINGVARIABLE&&o?{type:t.STRING,chars:e}:B(function(e){if(void 0===e)throw new Error("Undefined source!");const n=e.split(/\r?\n/);if(n.Length>1)throw new Error("Too many lines for an expression");const r=n[0];let o;try{o=A().parse(r)}catch(t){if("SyntaxError"!==t.name)throw t}return void 0!==o&&o.type===t.ValueStatement?o.value:{type:"SyntaxError"}}(e),r.mem),n.type===t.VARIABLE&&u.type===t.LIST&&(n={type:t.LISTVARIABLE,name:`List${n.name}`,custom:!0}),w(r.mem,n,u)}))}),r.io),E}H[t.EmptyStatement]=(t,e)=>{},H[t.AssignmentStatement]=(t,e)=>{const n=B(t.value,e.mem);!function(t,e,n){const r=P[t.type];if(void 0===r)throw d("unexpected assignable type");r(t,e,n)}(t.assignable,n,e.mem),k(e.mem,n)},H[t.ValueStatement]=(t,e)=>{k(e.mem,B(t.value,e.mem))},H[t.SyntaxError]=(t,e)=>{throw a},H[t.IfStatement]=(t,e)=>{if(null===t.value)throw s;e.ifResult=I(B(t.value,e.mem))},H[t.ThenStatement]=(t,e)=>{throw a},H[t.ElseStatement]=(e,n)=>{if(0===n.blockStack.length)throw a;if(n.lines[n.blockStack.pop()].type!==t.ThenStatement)throw a;n.blockStack.push(n.i),n.falsyStackHeight=n.blockStack.length},H[t.ForLoop]=(t,e)=>{if(null===t.variable||null===t.start||null===t.end)throw s;w(e.mem,t.variable,B(t.start,e.mem)),e.blockStack.push(e.i),I(B(x(t.variable,"<=",t.end),e.mem))||(e.falsyStackHeight=e.blockStack.length)},H[t.WhileLoop]=(t,e)=>{if(null===t.value)throw s;e.blockStack.push(e.i),I(B(t.value,e.mem))||(e.falsyStackHeight=e.blockStack.length)},H[t.RepeatLoop]=(t,e)=>{if(null===t.value)throw s;e.blockStack.push(e.i)},H[t.EndStatement]=(e,n)=>{if(0===n.blockStack.length)throw a;const r=n.blockStack.pop(),o=n.lines[r];if(o.type===t.ForLoop||o.type===t.WhileLoop||o.type===t.RepeatLoop)o.type===t.ForLoop?($(n.mem,o.variable,null!==o.step?o.step:S),I(B(x(o.variable,"<=",o.end),n.mem))&&(n.blockStack.push(r),n.i=r)):I(B(o.value,n.mem))&&(n.blockStack.push(r),n.i=r);else if(o.type!==t.ThenStatement&&o.type!==t.ElseStatement)throw d(`impossibleEndFrom'${o.type}`)},H[t.PauseStatement]=(t,e)=>{throw h},H[t.LabelStatement]=(t,e)=>{},H[t.GotoStatement]=(t,e)=>{e.searchLabel=t.location,e.i=-1},H[t.IncrementSkip]=(t,e)=>{if(null===t.variable||null===t.end)throw s;$(e.mem,t.variable,S),e.incrementDecrementResult=I(B(x(t.variable,"<=",t.end),e.mem))},H[t.DecrementSkip]=(t,e)=>{if(null===t.variable||null===t.end)throw s;$(e.mem,t.variable,b),e.incrementDecrementResult=I(B(x(t.variable,">=",t.end),e.mem))},H[t.MenuStatement]=(t,e)=>{if(null===t.title||0===t.choices.length||t.choices.length>7)throw s;return O(N(B(t.title,e.mem),!0),e.io),t.choices.forEach(((t,n)=>{O(`${n+1}:${N(t.option)}`,e.io)})),F((n=>{const r=function(t){if(null==t||""===t||t.length>1)return;const e=t.charCodeAt(0)-"0".charCodeAt(0);return e<0||e>9?void 0:e}(n);if(void 0===r||0===r||r>t.choices.length)return!0;e.searchLabel=t.choices[r-1].location,e.i=0,e.resume()}),e.io),E},H[t.ProgramStatement]=(t,e)=>{throw h},H[t.ReturnStatement]=(t,e)=>y,H[t.StopStatement]=(t,e)=>y,H[t.DelVarStatement]=(t,e)=>{if(null===t.variable)throw s;var n,r;n=e.mem,r=t.variable,delete n.vars[r.name]},H[t.GraphStyleStatement]=(t,e)=>{throw h},H[t.OpenLibStatement]=(t,e)=>{throw h},H[t.ExecLibStatement]=(t,e)=>{throw h},H[t.Display]=(t,e)=>{null!==t.value&&O(N(B(t.value,e.mem)),e.io)},H[t.Input]=(t,e)=>{if(null===t.variable){if(null!==t.text)throw s;throw h}let n="?";return null!==t.text&&(n=N(B(t.text,e.mem),!0)),Y(n,t.variable,e,!0)},H[t.Prompt]=(e,n)=>{if(null===e.variable)throw s;return Y(`${function(e){let n=e.name;switch(e.type){case t.VARIABLE:case t.STRINGVARIABLE:break;case t.LISTVARIABLE:n=n.substring(4),e.custom||(n=`&L${n}`);break;default:throw d("unexpected variable tostring")}return n}(e.variable)}=?`,e.variable,n,!1)},H[t.DispGraph]=(t,e)=>{throw h},H[t.DispTable]=(t,e)=>{throw h},H[t.Output]=(e,n)=>{if(null===e.row||null===e.column||null===e.value)throw s;const r=B(e.row,n.mem),o=B(e.column,n.mem);if(r.type!==t.NUMBER||o.type!==t.NUMBER)throw u;if(r.float<1||r.float>n.rows||o.float<1||o.float>n.columns)throw m;O(N(B(e.value,n.mem)),n.io)},H[t.ClrHome]=(t,e)=>{throw h},H[t.ClrTable]=(t,e)=>{throw h},H[t.GetCalc]=(t,e)=>{throw h},H[t.Get]=(t,e)=>{throw h},H[t.Send]=(t,e)=>{throw h};const j="daemon-loop",W="daemon-exception",K={},X=[];let q=!1,Q=0;const Z=document.createTextNode(null);function _(t){const e=new Event(t);Z.dispatchEvent(e)}function z(){!1===q&&(q=!0,_("start"),window.postMessage(j,"*"))}function J(t){if(console.debug(`[Task ${t}] Suspend`),!(t in K))throw new Error(`Error suspending: task '${t}' not found`);K[t].suspended=!0}function tt(t){console.debug(`[Task ${t}] Stop`),delete K[t]}window.addEventListener("message",(function(t){if(t.source!==window||t.data!==j)return;t.stopPropagation();const e=performance.now(),n=Object.keys(K);let r=0,o=0;n.forEach((t=>{const n=K[t];let u;if(!0===n.suspended)u=0,o+=1;else if(r+=1,void 0===n.lastRun||n.runOnce)u=1;else{const t=e-n.lastRun;u=Math.floor(t/n.delay)}u>0&&(n.lastRun=e);for(let e=0;e<u;e++){let e;try{e=n.func()}catch(t){e=g,X.length<1e3&&(X.push(t),window.postMessage(W,"*"))}if(e===y||n.runOnce||n.stopOnException&&e===g){tt(t),r-=1;break}if(e===E){J(t),r-=1,o+=1;break}if("yield"===e)break}})),0===r?(q=!1,_(o>0?"suspend":"stop")):window.postMessage(j,"*")}),!0),window.addEventListener("message",(function(t){if(t.source===window&&t.data===W&&X.length>0)throw X.pop()}),!0);const et=Z.addEventListener.bind(Z);function nt(e,n={}){let r=[];void 0!==n.source&&(r=Array.isArray(n.source)?n.source:n.source.split(/\r?\n/));let o=1;void 0!==n.frequencyMs&&(o=n.frequencyMs);let u=n.outputCallback;var i;void 0!==n.elem&&(i=n.elem,u=(t,e)=>{setTimeout((()=>{let n=i.val()+t;e&&(n+="\n"),i.val(n)}),0)});const c={mem:{vars:{},ans:v()},resume:void 0,resumeCallback:void 0,debug:!0===n.debug,sourceLines:r,searchLabel:void 0,ifResult:void 0,incrementDecrementResult:void 0,maximumLines:50,linesRun:0,blockStack:[],falsyStackHeight:void 0,falsyBlockPreviousIf:void 0,i:0,lines:e,callback:n.callback,frequencyMs:o,status:"pending",rows:8,columns:16,io:{output:u,input:n.input,stdin:n.stdin,includeErrors:void 0===n.includeErrors||!0===n.includeErrors,includeLibErrors:void 0===n.includeLibErrors||!0===n.includeLibErrors,includeLineNumbers:void 0===n.includeLineNumbers||!0===n.includeLineNumbers,includeSource:void 0===n.includeSource||!0===n.includeSource}},p=(f=()=>function(e){let n;try{e.status="running",n=function(e){if(e.debug&&console.debug({Line:e.i,searchLabel:e.searchLabel,ifResult:e.ifResult,blockStack:e.blockStack,falsyStackHeight:e.falsyStackHeight,falsyBlockPreviousIf:e.falsyBlockPreviousIf,source:e.source,mem:e.mem}),void 0!==e.resumeCallback&&(e.resumeCallback(),e.resumeCallback=void 0),e.i>=e.lines.length){if(void 0!==e.searchLabel)throw l;if(void 0!==e.ifResult||void 0!==e.incrementDecrementResult)throw a;return e.debug&&console.debug(e.mem),y}if(e.linesRun++,e.linesRun>=e.maximumLines)throw d("maxlines");const n=e.lines[e.i],r=n.type;if(void 0!==e.falsyStackHeight){const n=e.blockStack[e.blockStack.length-1],o=e.lines[n];return(r===t.EndStatement||r===t.ElseStatement&&o.type===t.ThenStatement)&&(e.blockStack.pop(),e.blockStack.length<e.falsyStackHeight&&(e.falsyStackHeight=void 0)),(r===t.ForLoop||r===t.RepeatLoop||r===t.WhileLoop||r===t.ThenStatement&&!0===e.falsyBlockPreviousIf||r===t.ElseStatement&&o.type===t.ThenStatement)&&e.blockStack.push(e.i),void(e.falsyBlockPreviousIf=r===t.IfStatement)}if(e.falsyBlockPreviousIf=void 0,void 0===e.searchLabel){if(void 0!==e.ifResult){const n=!0!==e.ifResult;if(e.ifResult=void 0,r===t.ThenStatement)return e.blockStack.push(e.i),void(n&&(e.falsyStackHeight=e.blockStack.length));if(n)return}if(void 0!==e.incrementDecrementResult){const t=!0!==e.incrementDecrementResult;if(e.incrementDecrementResult=void 0,t)return}if(!0===n.extra)throw a;if(!0===n.args)throw s;return function(t,e){const n=H[t.type];if(void 0===n)throw d("unexpected");return n(t,e)}(n,e)}r===t.LabelStatement&&n.location===e.searchLabel&&(e.searchLabel=void 0)}(e)}catch(r){if(e.status="faulted",void 0===r.type)throw r;if(e.i<e.lines.length&&!0!==r.hideSource){let t=e.lines[e.i].source;void 0!==e.sourceLines&&(t=e.sourceLines[e.i]),r.source={index:e.i,line:t}}!function(e,n={}){if(e.type===t.ti&&!n.includeErrors||e.type===t.lib&&!n.includeLibErrors)return void console.log(e);let r="";e.type===t.ti?r+="ERR:":e.type===t.lib?r+="Error: ":r+="Unexpected: ",r+=e.code,n.includeLineNumbers&&void 0!==e.source&&void 0!==e.source.index&&(r+=` on line ${e.source.index}`),n.includeSource&&void 0!==e.source&&void 0!==e.source.line&&(r+=` :${e.source.line}`),O(r,n)}(r,e.io),n=y}return n===y?("faulted"!==e.status&&(e.status="done"),void 0!==e.callback&&setTimeout(e.callback,0)):e.i+=1,n}(c),function(t,e,n){const r=Q++;return console.debug(`[Task ${r}] Start`),K[r]={func:t,delay:Math.max(e,.001),lastRun:void 0,runOnce:n,stopOnException:!0,suspended:!1},z(),r}(f,c.frequencyMs));var f;return c.resume=t=>{c.resumeCallback=t,function(t){if(console.debug(`[Task ${t}] Resume`),!(t in K))throw console.debug(K),new Error(`Error resuming: task '${t}' not found`);K[t].suspended=!1,z()}(p)},{getStatus:()=>c.status,isActive:()=>"pending"===c.status||"running"===c.status,stop:()=>{!function(t={}){void 0!==t.input&&t.input.off("keypress")}(c.io),tt(p)}}}function rt(t,e){const n=ti.parse(t);ti.run(n,{outputCallback:e})}Z.removeEventListener.bind(Z)})(),ti=r})();
//# sourceMappingURL=ti.js.map